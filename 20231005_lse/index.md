# Urban Grammar

<CENTER>
    <h4>
    *Decoding urban form and function in Great Britain*
    </h4>
</CENTER>

<CENTER>
<SMALL>
<span style='color:#8fa37e'>**Department of Geography and Environment - LSE**</span>
</SMALL>
</CENTER>

<table>
    <col width="50%">
    <col width="50%">
    <tr>
        <td>
            <CENTER>
                <a href="https://darribas.org"><b>Dani Arribas-Bel</b></a>
                <br>`@darribas`
            </CENTER>
        </td>
        <td>
            <CENTER>
                <a href="https://martinfleischmann.net/"><b>Martin Fleischmann</b></a>
                <br>`@martinfleis`
            </CENTER>
        </td>
    </tr>

</table>

<table>
    <col width="33%">
    <col width="33%">
    <col width="33%">
    <tr>
        <td>
            <img src="../fig/pr/logo_liv.png" style="width:300px;vertical-align:middle;box-shadow:none">
        </td>
        <td>
            <img src="../fig/pr/logo_ati.png" style="width:300px;vertical-align:middle;box-shadow:none">
        </td>
        <td>
            <img src="../fig/pr/logo_gdsl.png" style="width:300px;vertical-align:middle;box-shadow:none">
        </td>
    </tr>
</table>

#
##

<CENTER>
<!-- Licensed to share -->
![](https://copyrightandhiphop.com/wp-content/uploads/2015/02/parental-sticker.jpg)
</CENTER>

## This talk... {data-transition="none"}

... **is *not* about**:

- Exogenous sources of variation
- Local Average Treatment Effects
- Quasi-natural experiments

## This talk... {data-transition="none"}

... **_is_ about**:

- üèôÔ∏è (<span class='hlg'>Urban</span>) form & function
- üìà Detailed, consistent & scalable (open) <span class='hlg'>data</span>
- Also: üó∫Ô∏è maps, üß± city structure, üõ∞Ô∏è satellites...

<aside class="notes">
- "data": i.e., opportunities/inputs for YOU
- Also, hey!, emojis!
</aside>

#
## (Urban) <br> Form & Function

## F&F: *What*

<div class='fragment'>
`Form`

<CENTER>
*What does it look like?*
</CENTER>

<CENTER>
<span style='color:#3b6e8c'>
"Physical structure and appearance of cities"
</span>
</CENTER>
</div>

<div class='fragment'>
`Function`

<CENTER>
*What is it used for?*
</CENTER>

<CENTER>
<span style='color:#3b6e8c'>
"Activities that take place within an environment"
</span>
</CENTER>
</div>

## F&F: *Why*

<table>
    <col width="50%">
    <col width="50%">
    <tr>
        <td>
            <CENTER>
                <span class='hlg'>*Encodes*</span> the <span style='color:#94666e'>past</span>
            </CENTER>
        </td>
        <td>
            <CENTER>
                <span class='hlg'>*Frames*</span> the <span style='color:#3b6e8c'>future</span>
            </CENTER>
        </td>
    </tr>
    <tr>
<td>
<div class='fragment fade-in-then-semi-out'>
- Geography
- History
- Technology
- ...
</div>
</td>
<td>
<div class='fragment fade-in-then-semi-out'>
- Productivity
- Sustainability
- Quality of Life
- ...
</div>
</td>
</tr>
</table>

## F&F: *Why*

<table>
<col width="33%" height="50%">
<col width="33%" height="50%">
<col width="33%" height="50%">
<tr>
    <td>
    <CENTER>
<img src="../fig/misc/ch_land_use.png" style="width:100%;vertical-align:middle">
    </CENTER>
    </td>

    <td>
    <CENTER>
<img src="../fig/misc/joue_density.png" style="width:100%;vertical-align:middle">
    </CENTER>
    </td>

    <td>
    <CENTER>
<img src="../fig/misc/cities_in_bad_shape.png" style="width:100%;vertical-align:middle">
    </CENTER>
    </td>
</tr>
<tr class='fragment'>
    <td>
    <CENTER>
<img src="../fig/misc/wb_pancakes.png" style="width:100%;vertical-align:middle">
    </CENTER>
    </td>

    <td>
    <CENTER>
<img src="../fig/misc/oecd_rethinking_sprawl.png" style="width:100%;vertical-align:middle">
    </CENTER>
    </td>

    <td>
    <CENTER>
<img src="../fig/misc/un_nua.png" style="width:100%;vertical-align:middle">
    </CENTER>
    </td>
</tr>
</table>

## F&F: *How*

<table>
<col width="33%" height="50%">
<col width="33%" height="50%">
<col width="33%" height="50%">
<tr>
    <td>
    <CENTER>
    ![](../fig/misc/esa_world_cover.png)
    </CENTER>
    </td>
    <td>
    <CENTER>
    ![](../fig/misc/urban_atlas.png)
    </CENTER>
    </td>
    <td>
    <CENTER>
    ![](https://www.bruna.nl/images/active/carrousel/fullsize/9781526402349_front.jpg)
    </CENTER>
    </td>
<tr>
    <td>
</table>

<aside class='notes'>
- It's a continuum from traditional (natural) land cover to (social) geodem
- The centre is a sparse area with some urban land use (e.g., Urban Atlas)
- Single-use, not morphology
</aside>

## 

<img src="../fig/sp_sig/venn.svg" style="width:100%;vertical-align:middle;box-shadow:none">

#
## {data-background-image="../fig/misc/urban_grammar_project.png" data-background-size="contain"}

## {data-transition="none"}

<CENTER>
    *Characterisations of space based on form and function designed to understand urban environments*
</CENTER>

## {data-transition="none"}

<CENTER>
    *<span class="hlg">Characterisations of space</span> based on form and function designed to understand urban
    environments*
</CENTER>

## {data-transition="none"}

<CENTER>
    *Characterisations of space based on <span class="hlg">form and function</span> designed to understand urban
    environments*
</CENTER>

## {data-transition="none"}

<CENTER>
    *Characterisations of space based on form and function designed to understand <span class="hlg">urban
        environments</span>*
</CENTER>

## British Signatures

## {data-transition="none" data-background-image="../fig/sp_sig/classes.png" data-background-size="contain"}

## {data-transition="none" data-background-image="../fig/empirical/signatures_scottish_belt.png" data-background-size="cover"}
## {data-transition="none" data-background-image="../fig/empirical/signatures_scottish_belt_countryside.png" data-background-size="cover"}
## {data-transition="none" data-background-image="../fig/empirical/signatures_scottish_belt_periphery.png" data-background-size="cover"}
## {data-transition="none" data-background-image="../fig/empirical/signatures_scottish_belt_urban.png" data-background-size="cover"}

##

<table>
<col width="50%">
<col width="50%">
<tr>
    <td>
    <CENTER>
<img src="../fig/sp_sig/london_web.png" style="width:100%;vertical-align:middle">
    </CENTER>
    </td>

    <td>
    <CENTER>
<img src="../fig/misc/cdrc_data_product.png" style="width:100%;vertical-align:middle">
    </CENTER>

<a href='https://urbangrammarai.xyz/great-britain/'><img src="../fig/misc/qr_web_map.gif" style="width:100px;vertical-align:middle;box-shadow:none"></a>
    </td>
</tr>
</table>

## Building *Spatial Signatures* {data-transition="none"}

<CENTER>
<SMALL>
<span style="color:#94666e">**[STAGE]**</span>
<span style="color:#3b6e8c">Delimiters</span>
<span style="color:#3b6e8c">Enclosure</span>
<span style="color:#bc5b4f">Anchors</span>
<span style="color:#bc5b4f">Encl. Tess.</span>
<span>Characters</span>
<span style="color:#bc5b4f">Clu</span>st<span style="color:#3b6e8c">ers</span>
<span style="color:#bc5b4f">Sig</span><span style="color:#efc758">nat</span><span style="color:#3b6e8c">ures</span>
</SMALL>
</CENTER>

<table>
<col width="33%">
<col width="33%">
<col width="33%">
<tr>
    <td>
    <CENTER>
    Enclosed Tessellation
    </CENTER>
    </td>
    <td>
    <CENTER>
    Embedding *form* & *function*
    </CENTER>
    </td>
    <td>
    <CENTER>
    Spatial Signatures
    </CENTER>
    </td>
</tr>

<tr>
    <td>
    <CENTER>
<img src="../fig/sp_sig/et_footprints_no_labels.svg" style="width:125px;height:125px;vertical-align:middle">
    </CENTER>
    </td>

    <td>
    <CENTER>
<img src="../fig/sp_sig/form_function_no_labels.svg" style="width:125px;height:125px;vertical-align:middle">
    </CENTER>
    </td>

    <td>
    <CENTER>
<img src="../fig/sp_sig/signatures_no_labels.svg" style="width:125px;height:125px;vertical-align:middle">
    </CENTER>
    </td>
</tr>

<tr>
    <td>
    <CENTER>
<img src="../fig/sp_sig/enclosures_no_labels.svg" style="width:75px;height:75px;vertical-align:middle">
<span>
    +
<img src="../fig/sp_sig/footprints_no_labels.svg" style="width:75px;height:75px;vertical-align:middle">
</span>
    </CENTER>
    </td>

    <td>
    <CENTER>
    </CENTER>
    </td>

    <td>
    <CENTER>
<img src="../fig/sp_sig/clusters_no_labels.svg" style="width:75px;height:75px;vertical-align:middle">
    </CENTER>
    </td>
</tr>

<tr>
    <td>
    <CENTER>
<img src="../fig/sp_sig/barrriers_no_labels.svg" style="width:75px;height:75px;vertical-align:middle">
    </CENTER>
    </td>

    <td>
    <CENTER>
    </CENTER>
    </td>

    <td>
    <CENTER>
    </CENTER>
    </td>
</tr>

</table>



#
##

<CENTER>
&#x1F4E1; &#x1F30E; + &#x1F4BB;  + &#x1F916;
</CENTER>

## {data-transition="none" data-background-image="../fig/misc/nw_signatures.png" data-background-size="contain"}

## {data-transition="none" data-background-image="../fig/misc/nw_sentinel.png" data-background-size="contain"}

<span class="pie">Source: <a href='https://s2maps.eu/'>Sentinel-2 cloudless</a></span>

## {data-transition="none" data-background-image="../fig/gisruk/mor_country.png" data-background-size="contain"}

<span class="pie">Wild countryside (320x320m)</span>

## {data-transition="none" data-background-image="../fig/gisruk/mor_urban.png" data-background-size="contain"}

<span class="pie">Urbanity (320x320m)</span>

## {data-transition="none" data-background-image="../fig/isuf/mor_all.png" data-background-size="contain"}

<span class="pie">Predicted class (320x320m)</span>

##

<CENTER>
&#x1F4E1; &#x1F30E; + &#x1F4BB;  + &#x1F916;
</CENTER>

<div>
<span style='color:#8fa37e'>***Why***</span>

- Learn about Spatial Signatures (scale, context)
- Explore the role of space in NNs
- Work towards more frequent Spatial Signatures
</div>

#
## Experiment's dimensions

## Chip size
<table>
    <col width="25%">
    <col width="25%">
    <col width="25%">
    <col width="25%">
    <tr>
        <td>
        <CENTER>
        ![](../fig/gisruk/chips_80.png)
        <br>
        <SMALL>[74%]</SMALL>
        </CENTER>
        </td>
        <td>
        <CENTER>
        ![](../fig/gisruk/chips_160.png)
        <br>
        <SMALL>[57%]</SMALL>
        </CENTER>
        </td>
        <td>
        <CENTER>
        ![](../fig/gisruk/chips_320.png)
        <br>
        <SMALL>[35%]</SMALL>
        </CENTER>
        </td>
        <td>
        <CENTER>
        ![](../fig/gisruk/chips_640.png)
        <br>
        <SMALL>[13%]</SMALL>
        </CENTER>
        </td>
    </tr>
</table>

## (Spatial) data augmentation

<CENTER>
![](../fig/ai/sliding.png)
</CENTER>

## Model architecture

<table>
<col width="30%">
<col width="70%">
<tr>
<td>
`EfficientNetB4`

- Image Classification
- Multi-Output Regression
</td>
<td class='fragment'>
<CENTER>
<img src="../fig/ai/chip_prob_modeling.png" style="width:500px;vertical-align:middle;box-shadow:none">
</CENTER>
</td>
</tr>
</table>

## Evaluation

<table>
    <col width="35%">
    <col width="65%">
    <tr>
        <td>
`Metrics`

- Standard <br> [$\kappa$, accuracy, F1]()
- Spatial <br> [Joint Counts]()
        </td>
<td class='fragment'>
`Summarisation`
<br>
<img src="../fig/ai/summary_reg_1.png" style="width:500px;vertical-align:middle;box-shadow:none">
<br>
<img src="../fig/ai/summary_reg_2.png" style="width:850px;vertical-align:middle;box-shadow:none">
        </td>
    </tr>
</table>

#
## Results

## {data-transition="none" data-background-image="../fig/ai/results_table_1.png" data-background-size="contain"}
## {data-transition="none" data-background-image="../fig/ai/results_table_2.png" data-background-size="contain"}
## {data-transition="none" data-background-image="../fig/ai/results_table_3.png" data-background-size="contain"}

## Summarisation summary

- <span class='hlg'>Extra ML</span> pays off
- M.O.R. worse in general, better _within_ class
- <span class='hlg'>Spatial context</span> *always* improves performance
- <span class='hlg'>Scale</span>: larger is better, except for spatial patterning
- <span class='hlg'>Spatial sliding</span> rarely (within-class)

#
## Wrap up
## Wrap up

<center>
<img src="https://images.gr-assets.com/hostedimages/1509307588ra/24308520.gif" style="width:300px;vertical-align:middle;box-shadow:none">
</center>

<center>
<small>[[Source]](https://images.gr-assets.com/hostedimages/1509307588ra/24308520.gif)</small>
</center>

## Wrap up

- We *need* to <span class='hlg'>measure cities</span> more, more frequently
- We *can* thanks to the &#x1F4E1; &#x1F30E; + &#x1F4BB;  + &#x1F916; combo
- *How* is still <span class='hlg'>W.I.P.</span>, but with a stress on the **P**

# Urban Grammar

<CENTER>
    <h4>
    *Decoding urban form and function in Great Britain*
    </h4>
</CENTER>

<CENTER>
<SMALL>
<span style='color:#8fa37e'>**Department of Geography and Environment - LSE**</span>
</SMALL>
</CENTER>

<table>
    <col width="50%">
    <col width="50%">
    <tr>
        <td>
            <CENTER>
                <a href="https://darribas.org"><b>Dani Arribas-Bel</b></a>
                <br>`@darribas`
            </CENTER>
        </td>
        <td>
            <CENTER>
                <a href="https://martinfleischmann.net/"><b>Martin Fleischmann</b></a>
                <br>`@martinfleis`
            </CENTER>
        </td>
    </tr>

</table>

<table>
    <col width="33%">
    <col width="33%">
    <col width="33%">
    <tr>
        <td>
            <img src="../fig/pr/logo_liv.png" style="width:300px;vertical-align:middle;box-shadow:none">
        </td>
        <td>
            <img src="../fig/pr/logo_ati.png" style="width:300px;vertical-align:middle;box-shadow:none">
        </td>
        <td>
            <img src="../fig/pr/logo_gdsl.png" style="width:300px;vertical-align:middle;box-shadow:none">
        </td>
    </tr>
</table>

#
## Appendix

## Meaningful spatial units
<CENTER>
Enclosed tessellation
</CENTER>

<table>
    <col width="25%" height="50%">
    <col width="25%" height="50%">
    <col width="25%" height="50%">
    <col width="25%" height="50%">
    <tr>
        <td>
            <CENTER>
                <img src="../fig/sp_sig/et_diagram_1.png" style="width:100%;vertical-align:middle;box-shadow:none">
            </CENTER>
        </td>

        <td>
            <CENTER>
                 <img src="../fig/sp_sig/et_diagram_2.png" style="width:100%;vertical-align:middle;box-shadow:none">
            </CENTER>
        </td>
        <td>
            <CENTER>
                 <img src="../fig/sp_sig/et_diagram_3.png" style="width:100%;vertical-align:middle;box-shadow:none">
            </CENTER>
        </td>

        <td>
            <CENTER>
                 <img src="../fig/sp_sig/et_diagram_4.png" style="width:100%;vertical-align:middle;box-shadow:none">
            </CENTER>
        </td>
    </tr>
</table>

## Hierarchy

<table>
    <col width="35%">
    <col width="75%">
    <tr>
        <td class='fragment fade-in-then-semi-out'>
            <CENTER>
<img src="../fig/empirical/geog_distribution_co_occurence.svg" style="width:100%;vertical-align:middle">
            </CENTER>
        </td>
        <td class='fragment'>
            <CENTER>
<img src="../fig/empirical/hierarchy.png" style="width:100%;vertical-align:middle">
            </CENTER>
        </td>
    </tr>
</table>

## Sub-classifications

<table>
<col width="50%">
<col width="50%">
<tr>
    <td>
    <CENTER>
<a href='https://strathprints.strath.ac.uk/80527/1/Fleischmann_Bel_ISUF_2021_Classifying_urban_form_at_national_scale.pdf'><img src="../fig/misc/morphosignatures.png" style="width:100%;vertical-align:middle"></a>
    </CENTER>

<img src="../fig/misc/qr_morphosignatures.gif" style="width:100px;vertical-align:middle;box-shadow:none">
<img src="../fig/misc/qr_data_in_brief.gif" style="width:100px;vertical-align:middle;box-shadow:none">
    </td>

    <td>
    <CENTER>
<a href='https://doi.org/10.1016/j.dib.2022.108335'><img src="../fig/misc/data_in_brief.png" style="width:100%;vertical-align:middle"></a>
    </CENTER>
    </td>
</tr>
</table>


<!-- ############################################################################### -->

## Why satellite data?

<table>
<col width="33%" height="50%">
<col width="33%" height="50%">
<col width="33%" height="50%">
<tr>
    <td>
    <CENTER>
<a href='https://landsat.gsfc.nasa.gov/'><img src="../fig/misc/landsat.png" style="width:100%;vertical-align:middle"></a>
    </CENTER>
    </td>

    <td>
    <CENTER>
<a href='https://sentinels.copernicus.eu/web/sentinel/home'><img src="../fig/misc/sentinel.png" style="width:100%;vertical-align:middle"></a>
    </CENTER>
    </td>

    <td>
    <CENTER>
<a href='https://www.planet.com/'><img src="../fig/misc/planet.png" style="width:100%;vertical-align:middle"></a>
    </CENTER>
    </td>
<tr class='fragment'>
    <td>
    <CENTER>
<a href='https://ghsl.jrc.ec.europa.eu/'><img src="../fig/misc/ghsl.png" style="width:100%;vertical-align:middle"></a>
    </CENTER>
    </td>

    <td>
    <CENTER>
<a href='https://www.dynamicworld.app/'><img src="../fig/misc/google_dw.png" style="width:100%;vertical-align:middle"></a>
    </CENTER>
    </td>

    <td>
    <CENTER>
<a href='https://livingatlas.arcgis.com/landcover/'><img src="../fig/misc/esri_lc.png" style="width:100%;vertical-align:middle"></a>
    </CENTER>
    </td>
</tr>
</tr>
</table>

